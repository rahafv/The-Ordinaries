{% extends 'base_content.html' %}
{% block title %}{{ book.title }}{% endblock %}
{% block content %}


<div class="container">
  <div id='third' class="row mt-3" style='display:none; background-color:gainsboro;'>
    <h5 style='padding-top: 30px;'>You might also like </h5>
    <div class='row mb-3'>
        {% for rec in recs %}
        <div class="col-sm-6 col-md-3 mb-2 mt-2 text-center">
              <img  src="{{ rec.image_url }}" style="height:180px; width:120px;">
              <a style=" display: -webkit-box; max-width: 200px; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;  font-style: italic; font-size: 18px;" href='{% url 'book_details' rec.id %}'  >{{rec.title}}</a>
              <span style=" display: -webkit-box; max-width: 180px; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden;  font-style: italic; font-size: 15px;"class="user-link">{{rec.author}}</span>
        </div>
      {% endfor %}
    </div>
  </div>

  <div class="row">
    <div class="col-12">
        <h2 class="d-flex justify-content-center mb-5">{{ book.title }} </h2>
        <span class="float-left">

          {% if reader %}
          <a  href='{% url 'add_book_to_list' book_id=book.id %}' class="bi-bookmark-check-fill"
          style="font-size: 1.8rem; color: green;"></a>
          {% else %}
            <a href='{% url 'add_book_to_list' book_id=book.id %}#third' class="bi-bookmark-plus"
            style="font-size: 1.8rem; color: grey;"></a>
          {% endif %}
        </span>
        <div class="row">
          <div class="col-4">
            <div class="row mt-5">
              <h5><div class="fw-light center">
              
                <i class="fa fa-star{% if book.average_rating < 1%}-o{% elif book.average_rating == 1 %}-half-o{% endif %}" aria-hidden="true"></i> 
                <i class="fa fa-star{% if book.average_rating < 3%}-o{% elif book.average_rating == 3 %}-half-o{% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if book.average_rating < 5%}-o{% elif book.average_rating == 5 %}-half-o{% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if book.average_rating < 7%}-o{% elif book.average_rating == 7  %}-half-o{% endif %}" aria-hidden="true"></i>
                <i class="fa fa-star{% if book.average_rating < 9%}-o{% elif book.average_rating == 9 %}-half-o{% endif %}" aria-hidden="true"></i> 
            {%if numberOfRatings%}
            <span>({{book.average_rating}}/10.0)</span>
            {%else%} 
                <span>( - /10.0)</span>
            {%endif%}
        </div></h5>
              <div>
                <img src= "{{ book.image_url }}" class=" image-thumbnail mb-3" width="330" height="460" />
              </div>
            </div>
            {% if not rating %}
              <form action="{% url 'add_review' book.id %}" method="post">
                {% csrf_token %}
                <h5>How do you rate this book?</h5>
                <div>
                  <div class="rate mb-2">
                    <input class="rate" type="radio" name="rating" id="rating10" value="5" /><label for="rating10" title="5"></label>
                    <input type="radio" name="rating" id="rating9" value="4.5" /><label for="rating9" title="4.5" class="half"></label>
                    <input type="radio" name="rating" id="rating8" value="4" /><label for="rating8" title="4"></label>
                    <input type="radio" name="rating" id="rating7" value="3.5" /><label for="rating7" title="3.5" class="half"></label>
                    <input type="radio" name="rating" id="rating6" value="3" /><label for="rating6" title="3"></label>
                    <input type="radio" name="rating" id="rating5" value="2.5" /><label for="rating5" title="2.5" class="half"></label>
                    <input type="radio" name="rating" id="rating4" value="2" /><label for="rating4" title="2"></label>
                    <input type="radio" name="rating" id="rating3" value="1.5" /><label for="rating3" title="1.5" class="half"></label>
                    <input type="radio" name="rating" id="rating2" value="1" /><label for="rating2" title="1"></label>
                    <input type="radio" name="rating" id="rating1" value="0.5" /><label for="rating1" title="0.5" class="half"></label>
                  </div>         
                  <textarea name="review" rows="4" class="form-control mb-3" placeholder="Write your review"></textarea>
                  <input type="submit" value="Submit Review" class="btn btn-dark mb-3">
                </div>
              </form>
            {%else%}
              <div>
                <b class="mt-2"> Your rating: </b> {{ rating.rating }}
                <br>
                <b class="mb-4"> Your review: </b> {{ rating.review  }} 
                <br>
                <br>
                <a href= '{% url 'edit_review' review_id=rating.id %}' class="btn btn-outline-dark mb-3"> Edit </a>
              </div>
            {% endif %}
          </div>
          <div class="col-4">
            <div class="row-2 mt-5">
            </div>
            <div class="row mt-5">
            <h4 class="mb-3">ISBN:</h4>
            <div class="card card-body mb-3 pb-0">
              <p>{{ book.ISBN }}</p>
            </div>
            <h4 class="mb-3">Author:</h4>
            <div class="card card-body mb-3 pb-0">
              <p>{{ book.author }}</p>
            </div>
            <h4 class="mb-3">Genre:</h4>
            <div class="card card-body mb-3 pb-0">
              <p>{{ book.genre }}</p>
            </div>
            <h4 class="mb-3">Describtion:</h4>
            <div class="card card-body mb-3 pb-0">
              <p>{{ book.describtion }}</p>
            </div>
            <h4 class="mb-3">Number of pages:</h4>
            <div class="card card-body mb-3 pb-0">
              <p>{{ book.pages_num }}</p>
            </div>
          </div>
        </div>
      </hr>
      <div class="container mt-5">
        <h5 class= "text-uppercase font-weight-bold">Reviews({{reviews_count}})</h5>
        <hr class= "at-0 pt-0">
        <div class="row">
          <div class="col-sm-7 mt-2">
          {% if reviews %}
            {% for review in reviews %}
            <div class='reviews-heading'>
              <h6 class="review-info-alternate-heading">
              <i class= "fas fa-user mr-1"> <a href= {% url 'profile' review.user.id  %}> {{review.user.username}} </a></i>
              <i class= "fa fa-clock mr-1"> </i> {{review.created_at}}
              </h6>
              <div class="rating-star">
              
                    <i class="fa fa-star{% if review.rating < 1%}-o{% elif review.rating == 1 %}-half-o{% endif %}" aria-hidden="true"></i> 
                    <i class="fa fa-star{% if review.rating < 3%}-o{% elif review.rating == 3 %}-half-o{% endif %}" aria-hidden="true"></i>
                    <i class="fa fa-star{% if review.rating < 5%}-o{% elif review.rating == 5 %}-half-o{% endif %}" aria-hidden="true"></i>
                    <i class="fa fa-star{% if review.rating < 7%}-o{% elif review.rating == 7  %}-half-o{% endif %}" aria-hidden="true"></i>
                    <i class="fa fa-star{% if review.rating < 9%}-o{% elif review.rating == 9 %}-half-o{% endif %}" aria-hidden="true"></i> 
                
                <span>( {{ review.rating }}/10.0 )</span>
            </div>
            </div> 
          <div class= "review-body mt-2">
            <p>{{review.review}}</p> 
          </div>
            {% endfor %}
      </div>
          {% endif %}
          
    </div>
    </div>
  </div>

<script>

  var currentPath = window.location.hash;
  if(currentPath.substring(1) == 'third'){
    const targetDiv = document.getElementById(currentPath.substring(1));

    if (targetDiv.style.display === "none") {
    targetDiv.style.display = "block";
    }
  }
  

</script>
</div>


{% endblock %}